# This file installs system-level packages required by the application.
# It uses a single, robust command to handle the installation of PostgreSQL
# development headers, ensuring compatibility and avoiding cache issues.

commands:
  01_install_postgres_devel:
    # This command chain does three things in order:
    # 1. Enables the PostgreSQL 14 extras repository (for Amazon Linux 2).
    # 2. Cleans the yum cache to ensure the new repository is recognized.
    # 3. Installs the postgresql-devel package without prompting (-y).
    command: "sudo amazon-linux-extras enable postgresql14 && sudo yum clean all && sudo yum install -y postgresql-devel"
    # We ignore errors in case this is run on a platform where this specific
    # command isn't needed (e.g., Amazon Linux 2023).
    ignoreErrors: true

# The 'packages' block has been removed because the command above now
# handles the entire installation process directly.

